<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Bacboo ‚Äî Espelho Inteligente</title>
<style>
body { font-family: Arial, sans-serif; background:#0f172a; color:#f8fafc; text-align:center; margin:0; padding:20px;}
h1 { color:#38bdf8; }
video { width:95%; max-width:500px; border:2px solid #38bdf8; border-radius:10px; margin-top:10px; }
button,input { margin:8px; padding:10px; border-radius:6px; font-weight:bold; }
button { background:#38bdf8; border:none; color:#0f172a; cursor:pointer; }
input { width:60%; border:2px solid #38bdf8; border-radius:6px; padding:8px; }
#output { background:#1e293b; border-radius:10px; padding:15px; margin-top:15px; text-align:left; }
</style>
</head>
<body>

<h1>Bacboo ‚Äî Espelho Inteligente</h1>
<p>Espelhe sua tela ou teste v√≠deo interno para an√°lise autom√°tica.</p>

<div>
<button onclick="startMirror()">üì∏ Espelhar Partida</button>
<button onclick="stopMirror()">üõë Parar</button>
</div>

<div>
<button onclick="loadInternalVideo()">‚ñ∂Ô∏è Teste V√≠deo Interno</button>
</div>

<video id="mirror" autoplay playsinline controls></video>

<div id="output">
<h3>üìä An√°lise Atual:</h3>
<p id="status">Aguardando in√≠cio...</p>
<p id="recomendacao"></p>
</div>

<script>
let stream=null;
let autoAnalyze=null;

async function startMirror() {
  try {
    stream = await navigator.mediaDevices.getDisplayMedia({video:true});
    const video=document.getElementById('mirror');
    video.srcObject=stream;
    document.getElementById('status').innerText='Espelho ativo, analisando...';
    autoAnalyze=setInterval(()=>analyzeVideoFrame(video),6000);
  } catch(err){
    alert('Permita o acesso √† tela para iniciar o espelho.');
    console.error(err);
  }
}

function stopMirror(){
  if(autoAnalyze) clearInterval(autoAnalyze);
  autoAnalyze=null;
  if(stream){
    const tracks=stream.getTracks();
    tracks.forEach(t=>t.stop());
    stream=null;
  }
  const video=document.getElementById('mirror');
  video.srcObject=null;
  video.src='';
  document.getElementById('status').innerText='Espelho parado.';
}

function loadInternalVideo(){
  stopMirror();
  const video=document.getElementById('mirror');
  // Coloque aqui seu v√≠deo de teste pequeno dentro da pasta do projeto
  video.src='./video-teste.mp4';
  video.play().then(()=>{
    document.getElementById('status').innerText='V√≠deo interno carregado, analisando...';
    autoAnalyze=setInterval(()=>analyzeVideoFrame(video),6000);
  }).catch(err=>{
    alert('Erro ao carregar v√≠deo: '+err.message);
    console.error(err);
  });
}

function analyzeVideoFrame(video){
  const canvas=document.createElement('canvas');
  canvas.width=video.videoWidth;
  canvas.height=video.videoHeight;
  const ctx=canvas.getContext('2d');
  ctx.drawImage(video,0,0,canvas.width,canvas.height);

  const analise=simulateSmartAnalysis();
  document.getElementById('recomendacao').innerText=analise.mensagem;
  document.getElementById('status').innerText=`Confian√ßa: ${analise.confianca}%`;
}

function simulateSmartAnalysis(){
  const rand=Math.random();
  let resultado,confianca;
  if(rand<0.45){
    resultado='üîµ Jogar no Player';
    confianca=82+Math.floor(Math.random()*8);
  } else if(rand<0.8){
    resultado='üî¥ Jogar no Banker';
    confianca=80+Math.floor(Math.random()*10);
  } else{
    resultado='üü¢ Empate detectado (Tie)';
    confianca=77+Math.floor(Math.random()*6);
  }
  return {mensagem:resultado,confianca};
}
</script>

</body>
</html>
